<div class="heading">
    <h2>User Levels</h2>
</div>
{if $view=='view'}
    <a class="btn btn-primary btn-sm pull-right" href="?mode=add">Add New Level <b>+</b></a>
    <br>
    <br>
    <table class="table table-bordered table-striped">
        <tr>
            <td>ID</td>
            <td>Name</td>
            <td>Active</td>
            <td>Users</td>
            <td>Actions</td>
        </tr>
        {assign var=levels value=$userquery->get_levels()}
        {section name=l loop=$levels}
            <tr>
                <td>{$levels[l].user_level_id}</td>
                <td>{$levels[l].user_level_name}</td>
                <td>{$levels[l].user_level_active}</td>
                <td>{$userquery->get_level_users($levels[l].user_level_id,true)}</td>
                <td><a href="?mode=edit&lid={$levels[l].user_level_id}">{lang code='edit'}</a>{if $levels[l].user_level_is_default !=yes} | <a href="?action=delete&lid={$levels[l].user_level_id}">{lang code='remove'}</a>{/if}</td>
            </tr>
            {sectionelse}
            <tr>
                <td>No Levels Were Found</td>
            </tr>
        {/section}
    </table>
{elseif $view=='edit' || $view=='add'}
    <form method="post">
        <h3>User Level Details</h3>
        <div class="form-group">
            <label for="level_name2">Level name</label>
            <input class="form-control" name="level_name" type="text" id="level_name2" value="{$level_details.user_level_name}"/>
            <input type="hidden" name="user_level_id" value="{$level_details.user_level_id}">
        </div>
        {assign var='types' value=$userquery->get_level_types()}
        {section name=t loop=$types}
            <h3>{$types[t].user_permission_type_name}</h3>
            {assign var=perms value=$userquery->get_permissions($types[t].user_permission_type_id)}
            <div class="row">
                {foreach from=$perms item=perm}
                    {if $perm.permission_id !=""}
                        <div class="col-md-4">
                            <div class="row">
                                <div class="col-md-10 col-md-offset-1 myWell">
                                    <div class="col-md-8 paddingTop">
                                        <strong>{$perm.permission_name}</strong><br/>
                                        <small><em>{$perm.permission_desc}</em></small>
                                    </div>
                                    <div class="col-md-4">
                                        <input type="checkbox" name="{$perm.permission_code}" value="yes" id="{$perm.permission_id}_yes" {if $level_perms[{$perm.permission_code}]==yes}checked{/if} class="ace ace-switch ace-switch-5 bootstrap-switch-on"/>
                                        <span class="lbl"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {else}
                        <div>
                            <div class="col-md-6">
                                <em>No Permission Found</em>
                            </div>
                        </div>
                    {/if}
                    {foreachelse}
                    <div>
                        <div>
                            <em>No Permission Found</em>
                        </div>
                    </div>
                {/foreach}
                {if $types[t].user_permission_type_id == '4'}
                    <div class="col-md-4">
                        <div class="row">
                            <div class="col-md-10 col-md-offset-1 myWell">
                                <div class="col-md-8 paddingTop">
                                    <strong>{lang('enable_channel_page')}</strong><br/>
                                    <small><em>{lang('enable_channel_page_desc')}</em></small>
                                </div>
                                <div class="col-md-4 mb-2">
                                    <input type="checkbox" name="enable_channel_page" value="yes" id="enable_channel_page_yes" {if $level_perms['enable_channel_page']==yes}checked{/if} class="ace ace-switch ace-switch-5 bootstrap-switch-on"/>
                                    <span class="lbl"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                {/if}
            </div>
        {/section}
        <input class="btn btn-primary btn-sm" type="submit"  id="button" value="{if $view == 'add'}{lang('add')}{elseif $view=='edit'}{lang('edit')}{/if}"/>
    </form>
{/if}

