function editEmailTemplate(e){showSpinner(),$.post({url:"/actions/admin_email_template_edit.php",data:{email_template_id:e},dataType:"json",success:e=>{$("#email_template > .row").html(e.template),$(".page-content").prepend(e.msg),initListenerEdit()}}).always(()=>hideSpinner())}function saveEmailTemplate(e){showSpinner(),$.post({url:"/actions/admin_email_template_save.php",data:e.serialize(),dataType:"json",success:e=>{$("#email_template > .row").html(e.template),$(".page-content").prepend(e.msg),initListenerEdit()}}).always(()=>hideSpinner())}function listEmailTemplate(){showSpinner(),$.post({url:"/actions/admin_email_template_list.php",dataType:"json",success:e=>{$("#email_template > .row").html(e.template),$(".page-content").prepend(e.msg),initListenerList()}}).always(()=>hideSpinner())}$(function(){initListenerList()});var timeout,delay=500;function initListenerEdit(){$("#email_template_content").off("keyup").on("keyup",function(){var e=$(this);clearTimeout(timeout),timeout=setTimeout(()=>{$("#render").html(e.val())},delay)}),$("#email_template_edit").off("submit").on("submit",function(e){e.preventDefault(),saveEmailTemplate($(this))}),$(".back_to_template_list").off("click").on("click",()=>{listEmailTemplate()})}function initListenerList(){$(".add_new_email_template_list").off("click").on("click",()=>{editEmailTemplate()}),$('input[name="make_default"]').change(function(e){confirm(confirm_default_template)?(showSpinner(),$('input[name="make_default"]').not(this).prop("checked",!1),$.ajax({url:"/actions/admin_email_make_default.php",type:"POST",data:$("#default_template").serialize(),dataType:"json",success:function(e){$("#email_template > .row").html(e.template),$(".page-content").prepend(e.msg),initListenerList()}}).always(()=>hideSpinner())):$(this).prop("checked",!1)})}