var p="ajax.php";function dbconnect(){$("#loading").html('<img src="images/loading.gif"/>');var t=$("#installation").serialize();$.post(p,t,function(t){t.err?($("#dbresult").show().html(t.err),$("#loading").html("")):$("#installation").submit()},"json")}function dodatabase(t){var e=$("#installation").serialize();e+="&step="+t,$.post(p,e,function(t){t.msg&&$("#dbresult").show().append(t.msg),t.err&&($(".errorDiv").show().append(t.err),$("#loading").attr("src","images/cross_arrow.png")),t.status&&$("#current").html(t.status),"forward"==t.step&&$("#installation").submit(),t.step&&"forward"!=t.step&&dodatabase(t.step)},"json")}function password(t,e){var r,s=0,i="";if(void 0==e)var e=!1;for(;s<t;)r=Math.floor(100*Math.random())%94+33,(e||(!(r>=33)||!(r<=47))&&(!(r>=58)||!(r<=64))&&(!(r>=91)||!(r<=96))&&(!(r>=123)||!(r<=126)))&&(s++,i+=String.fromCharCode(r));return i}function newpassword(){var t=password(8,!0);$("#genPass").html(t),$("#password").val(t)}function checkBeforeSubmit(t){var e=!1;if(t?confirm("Do you really want do go further without updating ?")&&(e=!0):e=!0,!e)return!1;$("#installation").trigger("submit")}$(document).ready(function(){$("[id^='skip_']").change(function(){this.checked?($(this).parent().find("[id$='_filepath']").val("").prop("disabled",!0),$(this).parent().find("[id$='_filepath_test']").addClass("disabled")):($(this).parent().find("[id$='_filepath']").prop("disabled",!1),$(this).parent().find("[id$='_filepath_test']").removeClass("disabled"))}),$("[id$='_filepath_test']").click(function(){$("#mode").val("precheck"),$("#installation").submit()});var t=$(".check_timezone");t.length>0&&($(".btn-primary").prop("disabled",!0),t.on("change",function(e){$(".alert-dismissable").remove(),$(t).removeClass("has-error"),$("#spinner-content").show(),$.post("check_timezone.php",{timezone:$(this).val()},function(e){e.success?$(".btn-primary").prop("disabled",!1):($(t).addClass("has-error"),$("#sub_container").prepend(e.msg),$(".btn-primary").prop("disabled",!0)),$("#spinner-content").hide()},"JSON")})),$("#submit_update").on("click",function(t){t.preventDefault(),checkBeforeSubmit(need_update)}),$(".update_core").on("click",function(){var t=$(this);$(".btn").prop("disabled","disabled"),$(".text").hide(),$(".spinner-content").show(),$.post({url:"update_core.php",dataType:"json",success(e){$(".btn").prop("disabled",""),$(".text").show(),$(".spinner-content").hide(),e.msg&&($("#resultDiv").show().html(e.msg),$(".errorDiv").hide().html(""),t.parent().parent().remove(),need_update=!1),e.err&&($(".errorDiv").show().html(e.err),$("#resultDiv").hide().html(""),$("#loading").attr("src","images/cross_arrow.png"))}})})});
