/*! @name videojs-quality-selector-hls @version 1.1.1 @license MIT */ !function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).videojsQualitySelectorHls=e(t.videojs)}(this,function(t){"use strict";var e,l=(e=t)&&"object"==typeof e&&"default"in e?e:{default:e};let i=l.default.getComponent("MenuButton"),n=l.default.getComponent("Menu"),s=l.default.getComponent("Component"),u=l.default.dom;function a(t){let e=new i(t,{title:t.localize("Quality"),name:"QualityButton",createItems:()=>[],createMenu:()=>{let t=new n(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var e;let l=u.createEl("li",{className:"vjs-menu-title",innerHTML:"string"!=typeof(e=this.options_.title)?e:e.charAt(0).toUpperCase()+e.slice(1),tabIndex:-1}),i=new s(this.player_,{el:l});this.hideThreshold_+=1,t.addItem(i)}if(this.items=this.createItems(),this.items)for(let a=0;a<this.items.length;a++)t.addItem(this.items[a]);return t}});return e}let o=l.default.getComponent("MenuItem");class r{constructor(t,e){this.player=t,this.config=l.default.obj.merge({vjsIconClass:"vjs-icon-hd",displayCurrentQuality:!1,placementIndex:0},e),t.ready(()=>{this.player.addClass("vjs-quality-selector-hls"),this.player.qualityLevels&&(this.createQualityButton(),this.bindPlayerEvents())})}getHls(){return this.player.tech({IWillNotUseThisInPlugins:!0}).hls}bindPlayerEvents(){this.player.qualityLevels().on("addqualitylevel",this.onAddQualityLevel.bind(this))}createQualityButton(){let t=this.player;this._qualityButton=new a(t);let e=t.controlBar.children().length-2,l=t.controlBar.addChild(this._qualityButton,{componentClass:"qualitySelector"},this.config.placementIndex||e);if(l.addClass("vjs-quality-selector"),this.config.displayCurrentQuality)this.setButtonInnerText("auto");else{let i=` ${this.config.vjsIconClass||"vjs-icon-hd"}`;l.menuButton_.$(".vjs-icon-placeholder").className+=i}l.removeClass("vjs-hidden")}setButtonInnerText(t){this._qualityButton.menuButton_.$(".vjs-icon-placeholder").innerHTML=t}getQualityMenuItem(t){let e=this.player;return function t(e,l,i,n){let s=new o(e,{label:l.label,selectable:!0,selected:l.selected||!1});return s.item=l,s.qualityButton=i,s.plugin=n,s.handleClick=function(){for(let t=0;t<this.qualityButton.items.length;++t)this.qualityButton.items[t].selected(!1);this.plugin.setQuality(this.item.value),this.selected(!0)},s}(e,t,this._qualityButton,this)}onAddQualityLevel(){let t=this.player,e=t.qualityLevels(),l=e.levels_||[],i=[];for(let n=0;n<l.length;++n){let{width:s,height:u}=l[n],a=s>u?u:s;if(a&&!i.filter(t=>t.item&&t.item.value===a).length){let o=this.getQualityMenuItem.call(this,{label:a+"p",value:a});i.push(o)}}i.sort((t,e)=>"object"!=typeof t||"object"!=typeof e||t.item.value<e.item.value?-1:t.item.value>e.item.value?1:0),i.push(this.getQualityMenuItem.call(this,{label:t.localize("Auto"),value:"auto",selected:!0})),this._qualityButton&&(this._qualityButton.createItems=function(){return i},this._qualityButton.update())}setQuality(t){let e=this.player.qualityLevels();this._currentQuality=t,this.config.displayCurrentQuality&&this.setButtonInnerText("auto"===t?t:`${t}p`);for(let l=0;l<e.length;++l){let{width:i,height:n}=e[l],s=i>n?n:i;e[l].enabled=s===t||"auto"===t}this._qualityButton.unpressButton()}getCurrentQuality(){return this._currentQuality||"auto"}}let h=function(t,e){let l=new r(t,e);return t.QualitySelectorHlsVjs=!0,l.defaultState={},l.VERSION="1.1.1",l},c=function(t){return h(this,l.default.obj.merge({},t))};return l.default.registerPlugin("qualitySelectorHls",c),c});
