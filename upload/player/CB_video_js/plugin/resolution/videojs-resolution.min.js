!function(){"use strict";var e=null;e=void 0===window.videojs&&"function"==typeof require?require("video.js"):window.videojs,function(e,t){var s,n={},i={},r={};function l(e,t,s,n){return(i={label:s,sources:t},"function"==typeof n)?n(e,t,s):(e.src(t.map(function(e){return{src:e.src,type:e.type,res:e.res}})),e)}var o=t.getComponent("MenuItem");class c extends o{constructor(e,t,s,n){super(e,t),this.onClickListener=s,this.label=n,this.src=t.src,this.on("click",this.onClick),this.on("touchstart",this.onClick),t.initialySelected&&(this.showAsLabel(),this.selected(!0),this.addClass("vjs-selected"))}showAsLabel(){this.label&&(this.label.innerHTML=this.options_.label)}onClick(e){this.onClickListener(this);var t=this.player_.currentTime(),s=this.player_.paused();this.showAsLabel(),this.addClass("vjs-selected"),"function"!=typeof e&&"function"==typeof this.options_.customSourcePicker&&(e=this.options_.customSourcePicker);var n="loadeddata";"none"===this.player_.preload()&&"Flash"!==this.player_.techName_&&(n="timeupdate"),l(this.player_,this.src,this.options_.label,e).one(n,function(){this.player_.currentTime(t),s||this.player_.play(),this.player_.handleTechSeeked_(),this.player_.trigger("resolutionchange"),1===$(".vjs-menu-item.vjs-selected .vjs-menu-item-text").closest(".vjs-menu.vjs-hidden").first().length&&$(".vjs-menu-item.vjs-selected .vjs-menu-item-text").closest(".vjs-menu.vjs-hidden").first().removeClass("vjs-hidden")})}}t.registerComponent("ResolutionMenuItem",c);var a=t.getComponent("MenuButton"),u="";class h extends a{constructor(e,s,n,i){if(u=s.sources,super(e,s,s,n),this.controlText(lang_quality),this.label=i,this.label.innerHTML=s.initialySelectedLabel,n.dynamicLabel)this.el().appendChild(i);else{var r=document.createElement("span");t.dom.addClass(r,"vjs-resolution-button-staticlabel"),this.el().appendChild(r)}}createItems(){var e=[],t=u&&u.label||{},s=function(t){e.map(function(e){e.selected(e===t),e.removeClass("vjs-selected")})};for(var n in t)t.hasOwnProperty(n)&&(e.push(new c(this.player_,{label:n,src:t[n],initialySelected:n===this.options_.initialySelectedLabel,customSourcePicker:this.options_.customSourcePicker},s,this.label)),r[n]=e[e.length-1]);return e}}t.registerComponent("ResolutionMenuButton",h),s=function(e){var s=t.obj.merge(n,e),o=this,c=document.createElement("span"),a={};function u(e,t){return e.res&&t.res?+t.res-+e.res:0}function d(e,t,s){null==e[t][s[t]]&&(e[t][s[t]]=[])}function p(e,t,s){e[t][s[t]].push(s)}t.dom.addClass(c,"vjs-resolution-button-label"),o.updateSrc=function(e){if(!e)return o.src();o.controlBar.resolutionSwitcher&&(o.controlBar.resolutionSwitcher.dispose(),delete o.controlBar.resolutionSwitcher);var n,i,r,m,v,b,f=(r=a=(n=e=e.sort(u),i={label:{},res:{},type:{}},n.map(function(e){d(i,"label",e),d(i,"res",e),d(i,"type",e),p(i,"label",e),p(i,"res",e),p(i,"type",e)}),i),m=e,v=s.default,b="","high"===v?(v=m[0].res,b=m[0].label):"low"!==v&&null!=v&&r.res[v]?r.res[v]&&(b=r.res[v][0].label):(v=m[m.length-1].res,b=m[m.length-1].label),{res:v,label:b,sources:r.res[v]}),y=new h(o,{sources:a,initialySelectedLabel:f.label,initialySelectedRes:f.res,customSourcePicker:s.customSourcePicker},s,c);return t.dom.addClass(y.el(),"vjs-resolution-button"),o.controlBar.resolutionSwitcher=o.controlBar.el_.insertBefore(y.el_,o.controlBar.getChild("fullscreenToggle").el_),o.controlBar.resolutionSwitcher.dispose=function(){this.parentNode.removeChild(this)},l(o,f.sources,f.label)},o.currentResolution=function(e,t){return null==e?i:(null!=r[e]&&r[e].onClick(t),o)},o.getGroupedSrc=function(){return a},o.ready(function(){o.options_.sources.length>1&&o.updateSrc(o.options_.sources)})},t.registerPlugin("videoJsResolutionSwitcher",s)}(window,e)}();
