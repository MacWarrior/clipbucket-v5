function headerFooter(){let e="",t="",o=0,n="",i="";n=$("#container").height(),e=$("#header").outerHeight(),t=$("#footer").outerHeight(),$("#cookie-banner").length>0&&(o=$("#cookie-banner").is(":visible")?$("#cookie-banner").outerHeight():0),i=n-(e+t+o),$("#container").css("padding-top",e+"px"),$("#container").css("padding-bottom",t+o+"px"),$(".account-container, .page-error").css("height",i+"px")}function shortKeys(){$(document).keypress(function(e){var t=e.which;$("#query,textarea,#name,#email").is(":focus")||("index"==pageNow?(70===t&&e.shiftKey&&$("#featured_load_more").trigger("click"),82===t&&e.shiftKey&&$("#recent_load_more").trigger("click")):"watch_video"==pageNow&&(70===t&&e.shiftKey&&($(".icon-plusrounded").trigger("click"),$("#addfav").trigger("click")),82===t&&e.shiftKey&&$(".icon-flag").trigger("click"),84===t&&e.shiftKey&&$("#comment_box").focus().select(),69===t&&e.shiftKey&&$(".icon-share").trigger("click")),83===t&&e.shiftKey&&$("#query").focus().select(),86===t&&e.shiftKey&&(window.location.href=baseurl+"videos"),80===t&&e.shiftKey&&(window.location.href=baseurl+"photos"),67===t&&e.shiftKey&&(window.location.href=baseurl+"collections"),85===t&&e.shiftKey&&(window.location.href=baseurl+"channels"))})}var flag=0;function responsiveFixes(){var e=$(window).width(),t=$("#header .menu-holder .user_menu").html(),o=$("#header .navbar-header"),n=$("#header .menu-holder");if(e<992)0==o.find(".user_menu").length&&$(o).append('<div class="col btn-holder user_menu text-right logged-out">'+t+"</div>"),$(".menu-holder").find(".user_menu").remove();else{var i=o.find(".user_menu").html();0==n.find(".user_menu").length&&n.append('<div class="col btn-holder user_menu text-right logged-out">'+i+"</div>"),o.find(".user_menu").remove()}if(e<1280?($(".btn-newacc .big").hide(),$(".btn-newacc .little").show()):($(".btn-newacc .big").show(),$(".btn-newacc .little").hide()),userid?($(".user_menu").addClass("logged-in"),$(".user_menu").removeClass("logged-out")):($(".user_menu").removeClass("logged-in"),$(".user_menu").addClass("logged-out")),e<768){if(0==$(".menu-holder").find(".newuser-links").length){var r=$(".navbar-right").html();$(".menu-holder").prepend("<ul class='newuser-links'>"+r+"</ul>"),$(".navbar-right").remove()}}else if(0==$(".user_menu").find(".right-menu").length){var a=$(".newuser-links").html();$(".user_menu").append("<ul class='nav navbar-nav navbar-right right-menu'>"+a+"</ul>"),$(".newuser-links").remove()}}function thakkiLoading(e){$("html, body").stop(),$("html, body").animate({scrollTop:e},1900,"swing")}function preLoadingBlock(){var e=$(".featured-videos .thumb-video").width();$(".featured-videos .thumb-video").css("height",.625*e+"px");var t=$(".videos .thumb-video").width();$(".videos .thumb-video").css("height",.625*t+"px")}function loginHeight(){var e=$("#login_form").outerHeight();e-=40,$(".account-holder .side-box").css("height",e+"px")}function adaptRatioPlayer(){let e=document.querySelector(".player-holder");if(null===e)return;let t=document.querySelector(".player-holder video");if(null===t)return;let o=e.querySelector(".cb_player");if(o&&o.style.aspectRatio&&""!==o.style.aspectRatio)return;let n=window.innerWidth/window.innerHeight,i=t.videoWidth/t.videoHeight;e.style.aspectRatio=i,n>i?e.classList.add("fix_ratio"):e.classList.remove("fix_ratio")}let listenerModernThumbVideo=function(e){"IMG"===e.target.tagName&&(document.location.href=this.getAttribute("data-href"))},AddingListenerModernThumbVideo=function(){document.querySelectorAll(".thumb-video:not(.cd-popup-trigger)").forEach(function(e){e.removeEventListener("click",listenerModernThumbVideo),e.addEventListener("click",listenerModernThumbVideo)})},listenerModernThumbVideoPopinView=function(e){if("IMG"!==e.target.tagName)return;$(".cd-popup").addClass("is-visible");let t=this.getAttribute("data-videoid");_cb.getModalVideo(t)},AddingListenerModernThumbVideoPopinView=function(){document.querySelectorAll(".thumb-video.cd-popup-trigger").forEach(function(e){e.removeEventListener("click",listenerModernThumbVideoPopinView),e.addEventListener("click",listenerModernThumbVideoPopinView)})};function homePageVideos(e){$("#container").on("click","#recent_load_more, #featured_load_more",function(){var e,t,o=baseurl+"ajax/home.php",n=$(this),i=$(n).attr("loadtype"),r=$(n).attr("loadmode"),a=($(n).attr("loadlimit"),!0),s=!0,l="",d=$("#featured_vid_sec .item-video, #featured_vid_sec .slider-video-container").length,c=$("#recent_vids_sec .item-video, #recent_vids_sec .slider-video-container").length,u=$("#container").find(".total_videos_featured").first().text(),h=$("#container").find(".total_videos_recent").first().text();if(first_launch=!0,""!=u||""!=h){""==u&&(u=0),""==h&&(h=0);var f=parseInt(u)-parseInt(d),m=parseInt(h)-parseInt(c);first_launch=!1}else{var f=2,m=3;first_launch=!0}f>2?l=2:(s=!1,l=f),m>3?recentFound=3:(a=!1,recentFound=m),"featured"==r?(e=d,t=l):(e=c,t=recentFound),$.ajax({url:o,type:"post",dataType:"json",data:{load_type:i,load_mode:r,current_displayed:e,wanted:t,first_launch:first_launch},beforeSend:function(){if($(n).attr("disabled","disabled"),$(n).text("Loading..."),"count"!=i){if("featured"==r){for(var e=0;e<l;e++)$(document).find("#featured_pre").append('<div class="item-video col-lg-6 col-md-6 col-sm-6 col-xs-12"><div style="height:200px;" class="thumb-video background-masker clearfix"></div></div>');var t=$(window).width();!first_launch&&t>767&&thakkiLoading($(".featAppending").last().offset().top)}else{for(var e=0;e<recentFound;e++)$(document).find("#recent_pre").append('<div class="item-video col-lg-4 col-md-4 col-sm-4 col-xs-6"><div class="thumb-video background-masker clearfix"></div><div class="loadingInfo video-info relative clearfix"><div class="background-masker heading clearfix"></div><div class="background-masker paragraph clearfix"></div><div class="background-masker clearfix views-date"></div></div></div>');preLoadingBlock();var t=$(window).width();!first_launch&&t>767&&thakkiLoading($("#recent_pre").last().offset().top)}}},success:function(e){var t=e;return t.notice?(first_launch?($(n).remove(),"featured"==r?($("#featured_load_more").hide(),$("#featured_pre").hide(),$("#featured_vid_sec").html('<span class="well well-info btn-block">'+langCo+"</span>")):"recent"==r&&($("#recent_load_more").remove(),$("#recent_pre").remove(),$("#recent_vids_sec").html('<span class="well well-info btn-block">'+noRecent+"</span>"))):_cb.throwHeadMsg("warning",t.notice,3e3,!0),!0):t.error?(_cb.throwHeadMsg("error",t.error,3e3,!0),!0):void($(n).removeAttr("disabled"),$(n).text(loadMoreLang),"video"==i&&("recent"==r?($("#recent_load_more").remove(),$("#recent_pre").html(""),$(t.html).appendTo("#recent_vids_sec").fadeIn("slow"),c=$("#recent_vids_sec .item-video, #recent_vids_sec .slider-video-container").length,h=$("#container").find(".total_videos_recent").first().text(),(m=parseInt(h)-parseInt(c))>0&&$(document).find("#recent-loadmore").append('<div class="clearfix text-center"><button id="recent_load_more" class="btn btn-loadmore" loadtype="video" loadmode="recent" title="'+loadMoreLang+'">'+loadMoreLang+"</button></div>"),progressVideoCheckHome(ids_to_check_progress_recent=[...new Set([...ids_to_check_progress_recent,...t.ids_to_check])],"home","intervalId_recent")):($("#featured_load_more").remove(),$("#featured_pre").html(""),$(t.html).appendTo("#featured_vid_sec").fadeIn("slow"),d=$("#featured_vid_sec .item-video, #featured_vid_sec .slider-video-container").length,u=$("#container").find(".total_videos_featured").first().text(),(f=parseInt(u)-parseInt(d))>0&&$(document).find("#featured-loadmore").append('<div class="clearfix text-center"><button id="featured_load_more" class="btn btn-loadmore" loadtype="video" loadmode="featured" title="'+loadMoreLang+'">'+loadMoreLang+"</button></div>"),progressVideoCheckHome(ids_to_check_progress_featured=[...new Set([...ids_to_check_progress_featured,...t.ids_to_check])],"home_featured","intervalId_featured"))),$("#container").find(".total_videos_recent").hide(),$("#container").find(".total_videos_featured").hide(),AddingListenerModernThumbVideo(),AddingListenerModernThumbVideoPopinView())}})}),$(document).ready(function(){$("#featured_load_more").trigger("click"),$("#featured_load_more").hide(),$("#recent_load_more").trigger("click"),$("#recent_load_more").hide()})}function updateCookieBannerPosition(){let e=document.getElementById("cookie-banner"),t=document.getElementById("footer");if(!e||!t)return;let o=t.getBoundingClientRect(),n=window.innerHeight||document.documentElement.clientHeight;if(o.top<n){e.classList.remove("sticky"),e.classList.add("above-footer");let i=e.offsetHeight;e.style.top=t.offsetTop-i+"px",e.style.bottom=""}else e.classList.remove("above-footer"),e.classList.add("sticky"),e.style.top="",e.style.bottom="0"}function showCookieBanner(){cookieConsent||(document.getElementById("cookie-banner").style.display="",updateCookieBannerPosition())}function hideCookieBanner(){document.getElementById("cookie-banner").style.display="none"}function showModal(){let e=document.getElementById("cookieListModal");if(e.classList.add("in"),e.style.display="block",!document.querySelector(".modal-backdrop")){let t=document.createElement("div");t.className="modal-backdrop fade in",t.onclick=closeModal,document.body.appendChild(t)}document.body.classList.add("modal-open"),document.getElementById("refuse_all_optionnal").onclick=function(){document.getElementById("cookie-preferences-form").querySelectorAll('input[type="checkbox"]:not(:disabled)').forEach(function(e){e.checked=!1}),saveCookiePreferences()},document.getElementById("accept_all_cookies").onclick=function(){document.getElementById("cookie-preferences-form").querySelectorAll('input[type="checkbox"]:not(:disabled)').forEach(function(e){e.checked=!0}),saveCookiePreferences()},document.getElementById("save_cookie_preferences").onclick=function(){saveCookiePreferences()}}function closeModal(){let e=document.getElementById("cookieListModal");e.classList.remove("in"),e.style.display="none",document.body.classList.remove("modal-open");let t=document.querySelector(".modal-backdrop");t&&t.parentNode.removeChild(t)}function renderCookieList(){let e=new XMLHttpRequest;e.open("GET",baseurl+"actions/cookie_consent_get.php",!0),e.onreadystatechange=function(){if(e.readyState===XMLHttpRequest.DONE)try{let t=JSON.parse(e.responseText);t&&t.template?(document.getElementById("cookie-list-content").innerHTML=t.template,showModal()):document.getElementById("cookie-list-content").innerHTML='<div class="alert alert-danger">Erreur lors de la r\xe9cup\xe9ration du contenu.</div>'}catch(o){document.getElementById("cookie-list-content").innerHTML='<div class="alert alert-danger">R\xe9ponse inattendue du serveur.</div>'}},e.send()}function ajaxSetConsent(e,t){let o=new XMLHttpRequest;o.open("POST",baseurl+"actions/cookie_consent_set.php",!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.onreadystatechange=function(){o.readyState===XMLHttpRequest.DONE&&"function"==typeof t&&t(o.responseText)},o.send("consent="+encodeURIComponent(e))}function fade(e,t="in",o=400){let n="in"===t?0:1,i="in"===t?1:0;"in"===t&&(e.style.opacity=n,e.style.display="");let r=null;function a(s){r||(r=s);let l=Math.min((s-r)/o,1),d;"in"===t?(d=n+(i-n)*l,e.style.opacity=d,l<1?requestAnimationFrame(a):e.style.opacity=i):(d=n-(n-i)*l,e.style.opacity=d,l<1?requestAnimationFrame(a):(e.style.opacity=i,e.style.display="none"))}requestAnimationFrame(a)}function checkDisabledFeatured(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t)){let o=0===e[t]?"out":"in",n,i,r;switch(t){case"fast_qlist":document.querySelectorAll(".cb_quickie").forEach(function(e){r="none"!==(i=window.getComputedStyle(e)).display&&parseFloat(i.opacity)>0,("in"===o&&!r||"out"===o&&r)&&fade(e,o,1e3)});let a=document.getElementById("qlist_main"),s=document.getElementById("qlist_count");a&&s&&""!==s.textContent.trim()&&"0"!==s.textContent.trim()&&(r="none"!==(i=window.getComputedStyle(a)).display&&parseFloat(i.opacity)>0,("in"===o&&!r||"out"===o&&r)&&fade(a,o,1e3));break;case"user_theme":n=document.querySelector(".theme-switch");break;case"user_theme_os":n=document.querySelector('.theme-switch button[data-theme="auto"]');break;case"cb_lang":n=document.querySelector(".langdrop")}n&&(r="none"!==(i=window.getComputedStyle(n)).display&&parseFloat(i.opacity)>0,("in"===o&&!r||"out"===o&&r)&&fade(n,o,1e3))}}function saveCookiePreferences(){let e=document.getElementById("cookie-preferences-form"),t={};e.querySelectorAll('input[type="checkbox"]').forEach(function(e){t[e.name]=e.checked?1:0}),ajaxSetConsent(JSON.stringify(t),function(e){closeModal(),hideCookieBanner(),checkDisabledFeatured(t)})}$(document).ready(function(){userid?($(".user_menu").addClass("logged-in"),$(".user_menu").removeClass("logged-out")):($(".user_menu").removeClass("logged-in"),$(".user_menu").addClass("logged-out")),responsiveFixes(),$(".navbar-sm-login-links a").click(function(){$("body").removeClass("sideactive")}),$(".btn-search-toggle").click(function(){$(".navbar-header").toggleClass("show-search")}),loginHeight(),AddingListenerModernThumbVideo(),AddingListenerModernThumbVideoPopinView(),window.addEventListener("resize",adaptRatioPlayer),$(".cbsearchtype a").on({click:function(e){e.preventDefault();let t=$(this).parents(),o=$(this).attr("valNow");$(".type").val(o),$(".cbsearchtype li").removeClass("active"),t.addClass("active")}}),$(".s-types").on("click",function(){let e=$(this).html();$(".search-type").html(e)}),$("#cbsearch").on("click",function(e){e.preventDefault();let t=$("#query").val();if(t.length<=2){let o=lang_search_too_short;o=o.replace("%s","<b>"+t+"</b>"),_cb.throwHeadMsg("warning",o,3e3,!0)}else $(".search-form").submit()});let e=matchMedia("(prefers-color-scheme: dark)").matches;console.log(`%cGreetings Adventurers!
%cHaving a look under the hood? Happy sneaking buddy!🕵️‍♂️
%c📬 Drop us an email for any questions : contact+clipbucket@oxygenz.fr
%c🛠️ Check out the project on GitHub: https://github.com/MacWarrior/clipbucket-v5`,`font-size:18px; font-weight:bold; color:${e?"#90ee90":"#2e7d32"}`,`font-size:14px; color:${e?"#ccc":"#444"}`,`font-size:14px; font-style:italic; color:${e?"#80d8ff":"#1565c0"}`,`font-size:14px; color:${e?"#ffeb3b":"#f57c00"}; font-weight: bold;`),headerFooter()}),$(window).resize(function(){preLoadingBlock(),responsiveFixes(),loginHeight(),headerFooter()}),document.addEventListener("DOMContentLoaded",function(){function e(e){jQuery.post({url:baseurl+"actions/switch_theme.php",dataType:"json",data:{theme:e,os:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},success:function(e){let t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href=e.url,document.head.appendChild(t),document.body.classList.add("theme_transition"),"dark"===e.theme?(document.documentElement.classList.remove("light"),document.documentElement.classList.add("dark")):(document.documentElement.classList.remove("dark"),document.documentElement.classList.add("light")),setTimeout(()=>{document.body.classList.remove("theme_transition")},1e3);let o=new CustomEvent("postThemeSwitch",{detail:{theme:e.theme}});document.dispatchEvent(o)}})}document.querySelectorAll("img[data-thumbs]").forEach(e=>{let t;try{let o=e.getAttribute("data-thumbs");t=JSON.parse(o)}catch(n){return}if(!Array.isArray(t)||0===t.length)return;let i=0,r,a=e.closest("div");a.addEventListener("mouseenter",function(){e.src&&(e.dataset.originalSrc=e.src),r=setInterval(()=>{t[i=(i+1)%t.length]&&(e.src=t[i])},500)}),a.addEventListener("mouseleave",function(){clearInterval(r),e.dataset.originalSrc&&(e.src=e.dataset.originalSrc),i=0})});document.querySelectorAll(".theme-switch button").forEach(t=>{t.addEventListener("click",()=>{if(t.classList.contains("active"))return;let o=document.querySelector(".theme-switch button.active");o&&o.classList.remove("active"),t.classList.add("active"),e(t.dataset.theme)})});let t=document.documentElement;t.classList.contains("auto")&&(t.classList.remove("auto"),e("auto")),document.querySelectorAll(".pick-lang").forEach(e=>{e.addEventListener("click",()=>{let t=e.dataset.lang,o=new URL(window.location.href),n=o.searchParams;n.set("set_site_lang",t),o.search=n.toString(),window.location=o.toString()})})}),window.addEventListener("scroll",updateCookieBannerPosition),window.addEventListener("resize",updateCookieBannerPosition),document.addEventListener("DOMContentLoaded",function(){showCookieBanner();let e=document.querySelectorAll(".show-cookie-list");for(let t=0;t<e.length;t++)e[t].onclick=function(e){renderCookieList()};document.getElementById("modal-close-btn").onclick=closeModal;document.querySelectorAll(".accept-cookies").forEach(function(e){e.onclick=function(){ajaxSetConsent("all",function(){closeModal(),hideCookieBanner()})}}),document.addEventListener("keydown",function(e){"Escape"===e.key&&closeModal()})});
