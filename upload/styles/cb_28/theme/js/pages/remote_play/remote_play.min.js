$(function(){$("#remote_play_form").find(".formSection h4").off("click").on({click:function(e){e.preventDefault(),$(this).find("i").hasClass("glyphicon-chevron-down")?($(this).find("i").removeClass("glyphicon-chevron-down").addClass("glyphicon-chevron-up"),$(this).next().slideDown("slow")):($(this).find("i").removeClass("glyphicon-chevron-up").addClass("glyphicon-chevron-down"),$(this).next().slideUp("slow"))}}),$("[id^=remote_tags]").each(function(e){init_tags(this.id,available_tags,"#remote_list_"+this.name)}),$("#remote_list_video_users").tagit({singleField:!0,fieldName:"tags",readOnly:!1,singleFieldNode:$("#remote_list_video_users").prevAll("#video_users"),animate:!0,caseSensitive:!1,allowSpaces:allow_username_spaces,beforeTagAdded:function(e,t){if(t.tagLabel.length<=2)return alert_shown||(alert_shown=!0,alert(tag_too_short)),!1;alert_shown=!1}}),$("#remote_play_form").find("#video_password").attr("disabled","disabled").parent().slideUp(),$("#remote_play_form").find("#video_users").attr("disabled","disabled").parent().slideUp(),$("#remote_play_form").find('[name="broadcast"]').off("click").on("click",function(){"unlisted"===$(this).val()?($(this).closest("form").find("#video_password").attr("disabled",!1).parent().slideDown(),$(this).closest("form").find("#video_users").attr("disabled","disabled").parent().slideUp()):"private"===$(this).val()?($(this).closest("form").find("#video_users").attr("disabled",!1).parent().slideDown(),$(this).closest("form").find("#video_password").attr("disabled","disabled").parent().slideUp()):($(this).closest("form").find("#video_password").attr("disabled","disabled").parent().slideUp(),$(this).closest("form").find("#video_users").attr("disabled","disabled").parent().slideUp())}),$("#remote_play_submit_form1").click(function(e){e.preventDefault(),$.ajax({url:remote_play_submit_form_url,type:"POST",data:{step:"check_link",remote_play_file_url:$("#remote_play_file_url").val()},dataType:"json",beforeSend:function(){$("#remote_play_submit_form1").attr("disabled",!0).html(remote_play_lang_checking)},success:function(e){if(e.error)$("#uploadMessage").html(e.error).attr("class","alert alert-danger").show(),setTimeout(function(){$("#uploadMessage").fadeOut(500)},5e3),$("#remote_play_submit_form1").attr("disabled",!1).html(remote_play_lang_submit_now);else{$("#remote_play_form").find('input[name="title"]').val(e.filename),$("#remote_play_form").find('textarea[name="description"]').val(e.filename),$("#remote_play_form").find('input[name="tags"]').val(e.filename);var t=!1;$("#remote_play_form").find("#list_tags").tagit({singleField:!0,readOnly:!1,singleFieldNode:$("#remote_play_form").find('input[name="tags"]'),animate:!0,caseSensitive:!1,availableTags:available_tags,beforeTagAdded:function(e,i){if(i.tagLabel.length<=2)return t||(t=!0,alert(tag_too_short)),!1;t=!1}}),$("#remote_play_submit_form1").fadeOut(250),$("#second-form").slideDown(1e3)}}})});var e="save";$("#remote_play_submit_form2").click(function(t){t.preventDefault(),$.ajax({url:remote_play_submit_form_url,type:"POST",data:{step:e,form_data:$("#remote_play_form").serialize()},dataType:"json",beforeSend:function(){$("#remote_play_submit_form2").attr("disabled",!0).html(remote_play_lang_saving)},success:function(t){$("#uploadMessage").html(t.msg).show(),setTimeout(function(){$("#uploadMessage").fadeOut(500)},5e3),t.error||("save"===e&&($("#remote_play_form").find('input[name="videokey"]').attr("disabled",!1).val(t.videokey),$("#remote_play_form").find('input[name="remote_play_file_url"]').attr("readonly",!0),e="update",intervalId=setInterval(function(){$.post({url:baseurl+"actions/progress_video.php",dataType:"json",data:{ids:[t.videoid],output:"watch_video",display_thumbs:!0,display_subtitles:!0},success:function(e){e.data.videos.forEach(function(e){if(e.percent>0||void 0===e.percent){if(0===$("#remote_play_form").find('[name="default_thumb"]').length&&void 0!==e.thumbs&&e.thumbs.length>0){let t=$(e.thumbs).hide();t.insertBefore($("#remote_play_form").find(".pad-bottom-sm.text-right")),t.slideDown("slow")}if(0===$("#remote_play_form").find("#subtitles_"+e.videoid).length&&void 0!==e.subtitles&&e.subtitles.length>0){let i=$(e.subtitles).hide();i.insertBefore($("#remote_play_form").find(".pad-bottom-sm.text-right")),i.slideDown("slow")}slideFormSection()}if("processing"===e.status.toLowerCase()){var a=$('.processing[data-id="'+e.videoid+'"]');0===a.length?$("#remote_play_form").find(".player-holder").html(e.html):a.find("span").html(e.percent+"%")}else $("#remote_play_form").find(".player-holder").html(e.html)}),e.all_complete&&clearInterval(intervalId)}})},3e4)),$("#remote_play_submit_form2").attr("disabled",!1).html(remote_play_lang_submit_now))}})})});
