function initListenerHome(){$(".cd-popup-trigger:not(.thumb-video)").on("click",function(e){e.preventDefault(),$(".cd-popup").addClass("is-visible")}),$(".cd-popup").on("click",function(e){($(e.target).is(".cd-popup-close")||$(e.target).is(".cd-popup")||$(e.target).is(".my-modal-content"))&&(e.preventDefault(),$(this).removeClass("is-visible"),videojs($(".my-modal-content").find("video")[0]).dispose(),$(".my-modal-content").html(""))})}function progressVideoCheckHome(e,i,t){let s,n,l,r="";switch(i){case"home_collection":r=collection_video_style;break;case"home":r=video_style;break;case"home_featured":r=featured_video_style;break;default:s="no"}"home_collection"===i||"home"===i?(s="modern"===r?".slider-video-container":".item-video",n="data-id",l=$("section.videos,section.default-slider")):"home_featured"===i&&(s="modern"===r?".slide.video-link":".item-video",n="modern"===r?"data-videoid":"data-id",l=$("section.featured-videos")),window[t]&&clearInterval(window[t]),e&&e.length>0&&(window[t]=setInterval(function(){$.post({url:baseurl+"actions/progress_video.php",dataType:"json",data:{ids:e,output:i},success:function(e){e.data.videos.forEach(function(e){let t=s+"["+n+'="'+e.videoid+'"]';if("processing"==e.status.toLowerCase()){var r=$('.processing[data-id="'+e.videoid+'"]');0==r.length?(".item-video"===s?l.find(t).html(e.html):l.find(t).replaceWith(e.html),"home_featured"==i&&"modern"==featured_video_style&&(slider.updateSlideListeners(),1===slider.slidesContainer.children.length&&slider.scrollToSlide(0)),l.find(t).fadeIn("slow")):r.find("span").html(e.percent+"%")}else".item-video"===s?l.find(t).html(e.html):l.find(t).replaceWith(e.html),"home_featured"==i&&"modern"==featured_video_style&&(slider.updateSlideListeners(),1===slider.slidesContainer.children.length&&slider.scrollToSlide(0)),l.find(t).fadeIn("slow")}),e.all_complete&&clearInterval(window[t]),AddingListenerModernThumbVideo(),AddingListenerModernThumbVideoPopinView()}})},6e4))}$(function(){document.querySelectorAll(".default-slider").forEach(function(e){let i=null,t=e.getAttribute("data-ratio")??1,s=e.querySelector(".slider-container-overflow"),n=s.querySelectorAll(".slider-video-container, .item-video");if(0===n.length)return;let l=s.getBoundingClientRect(),r=window.getComputedStyle(n[0]),d=parseInt(r.getPropertyValue("margin-left").replace("px",""))+parseInt(r.getPropertyValue("margin-right").replace("px","")),a=0,o=function(i){let t=Math.floor((l=s.getBoundingClientRect()).width/(150*i)-.5);t<=0&&(t=1);let n=Math.floor(l.width/(t+.5)-d-d/t);e.style.setProperty("--width",n+"px"),e.style.setProperty("--height",n/i+"px"),a=.25*n+d};o(t);let h=null;setInterval(function(){if(s.offsetWidth!==h){if(h=s.offsetWidth,o(t),null!==i){let e=i.getBoundingClientRect();s.classList.add("scrolling"),c(),s.scrollLeft+=e.left-l.left-a}s.dispatchEvent(new CustomEvent("scroll"))}},400);let c=function(){for(let e=0;e<n.length;e++){let i=n[e];i.classList.remove("disabled"),i.classList.remove("disabled-prev"),i.classList.remove("disabled-next"),i.removeAttribute("title")}},m=function(){e.querySelector(".prev").dispatchEvent(new CustomEvent("click")),this.removeEventListener("click",m)},u=function(){e.querySelector(".next").dispatchEvent(new CustomEvent("click")),this.removeEventListener("click",u)},f=function(){for(let e=0;e<n.length;e++){let i=n[e],t=i.getBoundingClientRect();if(t.left<l.left&&t.right>l.left){i.classList.add("disabled"),i.classList.add("disabled-prev"),void 0!==previousLang&&i.setAttribute("title",previousLang),i.addEventListener("click",m);break}}for(let s=n.length-1;s>=0;s--){let r=n[s],d=r.getBoundingClientRect();if(d.left<l.right&&d.right>l.right){r.classList.add("disabled"),r.classList.add("disabled-next"),void 0!==nextLang&&r.setAttribute("title",nextLang),r.addEventListener("click",u);break}}},v=null;s.addEventListener("scroll",function(e){null!==v&&clearTimeout(v),v=setTimeout(function(){c(),f(),s.classList.remove("scrolling"),clearTimeout(v)},100)}),s.dispatchEvent(new CustomEvent("scroll")),e.querySelector(".slider-container-action .next").addEventListener("click",function(){let e=s.getBoundingClientRect();for(let t=0;t<n.length;t++){let l=n[t],r=l.getBoundingClientRect();if(r.right>e.right){s.classList.add("scrolling"),c(),s.scrollLeft+=r.left-e.left-a,i=l;break}}}),e.querySelector(".slider-container-action .prev").addEventListener("click",function(){let e=s.getBoundingClientRect();for(let t=0;t<n.length;t++){let l=n[t],r=l.getBoundingClientRect();if(r.left+s.scrollLeft-e.left>s.scrollLeft-e.width+a){s.classList.add("scrolling"),c(),s.scrollLeft+=r.left-e.left-a,i=l;break}}})});class e{constructor(e){this.slidesContainerMain=e,this.slidesContainer=this.slidesContainerMain.querySelector(".slides"),this.animationTime=parseInt(this.slidesContainerMain.dataset.animationTime)||300,this.timerAutoNext=parseInt(this.slidesContainerMain.dataset.timerAutoNext)||5e3,this.visibleSlides=parseInt(this.slidesContainerMain.dataset.nbLeft)||1,this.main_height=this.slidesContainerMain.dataset.heightSlider??"300px",this.visibleSlides+2>this.getNumberOfSlides()&&(this.visibleSlides=this.getNumberOfSlides()-2),(isNaN(this.visibleSlides)||this.visibleSlides<0)&&(this.visibleSlides=0),(isNaN(this.animationTime)||this.animationTime<0)&&(this.animationTime=0),this.isAnimating=!1,this.initialize()}initialize(){this.updateSlideListeners(),this.addNavigationButtons(),this.initializeResizeObserver(),this.initializeResizeObserverParent();let e=this.slidesContainer.children.length;if(0===e)this.slidesContainerMain.style.display="none";else if(1===e)this.scrollToSlide(0);else{let i=e>=this.visibleSlides?this.visibleSlides:1;this.scrollToSlide(i)}this.slidesContainerMain.style.setProperty("--height-slider-featured",this.main_height),this.slidesContainerMain.style.setProperty("--animation-time",this.animationTime+"ms");let t=this;this.slidesContainerMain.addEventListener("mouseover",function(){clearInterval(t.interval)}),this.slidesContainerMain.addEventListener("mouseleave",function(){t.resetTimer()})}resetTimer(){if(1>=this.getNumberOfSlides())return;let e=this;clearInterval(this.interval),this.interval=setInterval(function(){e.nextSlide()},this.timerAutoNext+this.animationTime)}getComputedCSSVariable(e){let i=document.createElement("div");i.style.position="absolute",i.style.visibility="hidden",i.style.width="var("+e+")",this.slidesContainerMain.appendChild(i);let t=getComputedStyle(i).width;return this.slidesContainerMain.removeChild(i),parseFloat(t)}getNumberOfSlides(){return this.slidesContainer.children.length}canDivGrowWidth(e,i){let t=e.parentElement,s=t.offsetWidth;return i<s}initializeResizeObserver(){let e=new ResizeObserver(e=>{let i=this.getComputedCSSVariable("--width-poster-base"),t=this.getComputedCSSVariable("--width-thumb"),s=this.getComputedCSSVariable("--width-collapsed"),n=i+t+(1+this.visibleSlides)*s;for(let l of e){let r=l.contentRect.width;r<=n&&this.getNumberOfSlides()>=2+parseInt(this.visibleSlides)&&!1===this.canDivGrowWidth(this.slidesContainerMain,n)?this.slidesContainerMain.classList.add("without_poster"):this.slidesContainerMain.classList.remove("without_poster");let d=this.slidesContainerMain.getBoundingClientRect(),a=this.slidesContainer.getBoundingClientRect();if(a.width>d.width&&!1===this.isAnimating){let o=Array.from(this.slidesContainer.children);if(void 0!==o[this.visibleSlides]){let h=Array.from(this.slidesContainer.children),c=h.findIndex(e=>e.classList.contains("active"));this.clearActiveSlide(),h[this.visibleSlides].classList.add("active"),this.scrollToSlide(c)}return}}});e.observe(this.slidesContainerMain)}initializeResizeObserverParent(){let e=new ResizeObserver(e=>{let i=this.getComputedCSSVariable("--width-poster-base"),t=this.getComputedCSSVariable("--width-thumb"),s=this.getComputedCSSVariable("--width-collapsed"),n=i+t+(1+this.visibleSlides)*s;for(let l of e){let r=l.contentRect.width;r<=n&&this.getNumberOfSlides()>=2+parseInt(this.visibleSlides)&&!1===this.canDivGrowWidth(this.slidesContainerMain,n)?this.slidesContainerMain.classList.add("without_poster"):this.slidesContainerMain.classList.remove("without_poster")}});e.observe(this.slidesContainerMain.parentElement)}getCurrentSlideActive(){let e=Array.from(this.slidesContainer.children),i=e.find(e=>e.classList.contains("active"));return i?e.indexOf(i):0}nextSlide(){let e=this.slidesContainer.children.length,i=(this.getCurrentSlideActive()+1)%e;this.scrollToSlide(i)}prevSlide(){let e=this.slidesContainer.children.length,i=(this.getCurrentSlideActive()-1+e)%e;this.scrollToSlide(i)}addNavigationButtons(){let e=this.slidesContainerMain.querySelector(".next-btn"),i=this.slidesContainerMain.querySelector(".prev-btn");e&&(e.onclick=()=>{this.nextSlide()}),i&&(i.onclick=()=>{this.prevSlide()})}moveXSlideToEnd(e,i,t){if(0===t&&(this.clearActiveSlide(),e[i].classList.add("active")),i===t+this.visibleSlides){this.isAnimating=!1;return}try{let s=e[t];s.classList.remove("active"),this.slidesContainer.appendChild(s.cloneNode(!0)),s.classList.add("removeAnimation");let n=this.animationTime/this.visibleSlides;if(t>0){let l=i-3;l<=0&&(l=3),(n/=l)<=75&&(n=75)}n===1/0&&(n=250),this.slidesContainerMain.style.setProperty("--animation-time",n+"ms"),s.style.transition="width "+n+"ms linear",setTimeout(()=>{s.remove(),s.style.transition="",this.updateSlideListeners(),this.moveXSlideToEnd(e,i,t+1)},n)}catch(r){throw this.isAnimating=!1,r}}moveXSlideToStart(e,i,t){if(t===this.slidesContainer.children.length-1&&(this.clearActiveSlide(),e[i].classList.add("active")),t===this.slidesContainer.children.length-1-(this.visibleSlides-i)){this.isAnimating=!1;return}try{let s=e[t];this.slidesContainer.insertBefore(s,this.slidesContainer.firstElementChild);let n=this.animationTime/this.visibleSlides;s.style.transition="width "+n+"ms linear",s.classList.add("animate-slide-in"),this.slidesContainerMain.style.setProperty("--animation-time",n+"ms"),setTimeout(()=>{s.classList.remove("animate-slide-in"),s.style.transition="",this.updateSlideListeners(),this.moveXSlideToStart(e,i,t-1)},n)}catch(l){throw this.isAnimating=!1,l}}scrollToSlide(e){if(this.isAnimating)return;this.isAnimating=!0,this.resetTimer();let i=Array.from(this.slidesContainer.children),t=i.findIndex(e=>e.classList.contains("active")),s=this.slidesContainerMain.getBoundingClientRect(),n=this.slidesContainer.getBoundingClientRect();if(n.width<=s.width){this.slidesContainerMain.style.setProperty("--animation-time",this.animationTime+"ms"),this.clearActiveSlide(),i[e].classList.add("active"),this.isAnimating=!1;return}e>t?this.moveXSlideToEnd(i,e,0):e<t?this.moveXSlideToStart(i,e,this.slidesContainer.children.length-1):this.isAnimating=!1}clearActiveSlide(){this.slidesContainer.querySelectorAll(".slide.active").forEach(e=>e.classList.remove("active"))}updateSlideListeners(){let e=this,i=Array.from(this.slidesContainer.children);i.forEach((i,t)=>{i.onclick=function(s){if(i.classList.contains("active")){if(i.classList.contains("cd-popup-trigger-slider")){$(".cd-popup").addClass("is-visible");let n=this.getAttribute("data-videoid");_cb.getModalVideo(n)}else document.location.href=i.getAttribute("data-href");return}e.scrollToSlide(t)}})}}document.querySelectorAll(".slider-container-featured").forEach(function(i){slider=new e(i)}),initListenerHome()});
