document.addEventListener("DOMContentLoaded",function(){init_tags("collection_tags",available_tags),document.querySelectorAll(".formSection h4").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault();var e=this.querySelector("i"),t=this.nextElementSibling;e.classList.contains("glyphicon-chevron-down")?(e.classList.remove("glyphicon-chevron-down"),e.classList.add("glyphicon-chevron-up")):(e.classList.remove("glyphicon-chevron-up"),e.classList.add("glyphicon-chevron-down")),t.classList.toggle("hidden")})});var e=document.querySelector("select#type");e&&e.addEventListener("change",function(){showSpinner();var e=this.value,t=document.querySelector("#collection_id").value;fetch(baseurl+"actions/get_collection_update.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({type:e,id:t})}).then(e=>e.json()).then(e=>{if(e.msg&&(o=document.querySelector(".page-content"))&&o.insertAdjacentHTML("afterbegin",e.msg),e.sort_types&&0<Object.keys(e.sort_types).length){var t=document.querySelector("#sort_type");t.innerHTML="";for(const c in e.sort_types){var n=document.createElement("option");n.value=c,n.textContent=e.sort_types[c],t.appendChild(n)}}if(Array.isArray(e.parents)){const r=document.querySelector("#collection_id_parent");r.innerHTML="",e.parents.forEach(function(e){var t=document.createElement("option");t.value=e.id,t.innerHTML=e.name,null===e.id||"null"===e.id?r.insertBefore(t,r.firstChild):r.appendChild(t)});var o=r.querySelector("option");o&&(r.value=o.value)}}).catch(e=>console.error(e)).finally(hideSpinner)}),$("#collection_id_parent").select2({width:"100%"})});