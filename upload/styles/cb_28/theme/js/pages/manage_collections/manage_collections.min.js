document.addEventListener("DOMContentLoaded",function(){init_tags("collection_tags",available_tags),document.querySelectorAll(".formSection h4").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault();let t=this.querySelector("i"),n=this.nextElementSibling;t.classList.contains("glyphicon-chevron-down")?(t.classList.remove("glyphicon-chevron-down"),t.classList.add("glyphicon-chevron-up")):(t.classList.remove("glyphicon-chevron-up"),t.classList.add("glyphicon-chevron-down")),n.classList.toggle("hidden")})});let e=document.querySelector("select#type");e&&e.addEventListener("change",function(){showSpinner();let e=this.value,t=document.querySelector("#collection_id").value;fetch(baseurl+"actions/get_collection_update.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({type:e,id:t})}).then(e=>e.json()).then(e=>{if(e.msg){let t=document.querySelector(".page-content");t&&t.insertAdjacentHTML("afterbegin",e.msg)}if(e.sort_types&&Object.keys(e.sort_types).length>0){let n=document.querySelector("#sort_type");for(let o in n.innerHTML="",e.sort_types){let l=document.createElement("option");l.value=o,l.textContent=e.sort_types[o],n.appendChild(l)}}if(Array.isArray(e.parents)){let i=document.querySelector("#collection_id_parent");i.innerHTML="",e.parents.forEach(function(e){let t=document.createElement("option");t.value=e.id,t.innerHTML=e.name,null===e.id||"null"===e.id?i.insertBefore(t,i.firstChild):i.appendChild(t)});let r=i.querySelector("option");r&&(i.value=r.value)}}).catch(e=>console.error(e)).finally(hideSpinner)})});
