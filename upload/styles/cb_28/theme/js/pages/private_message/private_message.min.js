var alert_shown=!1;function init_tags_to(e,a,n){void 0===n&&(n="#list_tags"),$(n).tagit({singleField:!0,fieldName:"tags",readOnly:!1,singleFieldNode:$("#"+e),animate:!0,caseSensitive:!1,availableTags:a,allowSpaces:is_space_in_username,beforeTagAdded:function(e,a){if(a.tagLabel.length<=2)return alert_shown||(alert_shown=!0,alert(tag_too_short)),!1;alert_shown=!1},afterTagAdded:function(e,a){let n=new URLSearchParams;a.tagLabel,n.append("username",a.tagLabel),putSpinnerOnTag(a.tag),fetch(baseurl+"actions/user_check.php",{method:"POST",headers:{Accept:"application/json"},body:n}).then(e=>e.json()).then(e=>{e.success?e.success&&(a.tag.addClass("success-important"),a.tag.find("span.tagit-label").append('<i class="fa fa-check"  aria-hidden="true"></i>'),a.tag.find("a").show(),a.tag.prop("title",lang.checked_user)):(document.querySelector(".manage-page").insertAdjacentHTML("afterbegin",e.msg),a.tag.addClass("danger-important"),a.tag.find("span.tagit-label").append('<i class="fa fa-warning" aria-hidden="true"></i>'),a.tag.prop("title",e.text_msg),setTimeout(function(){a.tag.fadeOut(500,function(){a.tag.find("a").trigger("click")})},5e3)),removeSpinnerOnTag(a.tag)})}})}function putSpinnerOnTag(e){e.append('<i class="fa fa-spinner fa-spin"></i>'),e.find("a").hide(),e.prop("title",lang.running_verification)}function removeSpinnerOnTag(e){e.find("i.fa-spinner").remove()}document.addEventListener("DOMContentLoaded",function(){init_tags_to("to");let e=document.querySelectorAll(".manage-page");e.forEach(e=>{let a=new MutationObserver(e=>{for(let a of e)a.addedNodes.forEach(e=>{1===e.nodeType&&e.classList.contains("alert")&&setTimeout(function(){$(e).slideUp(500,function(){$(this).remove()})},5e3)})});a.observe(e,{childList:!0,subtree:!0})})});
