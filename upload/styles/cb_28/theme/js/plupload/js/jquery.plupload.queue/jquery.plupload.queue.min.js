!function(n){var _={};function r(l){return plupload.translate(l)||l}n.fn.pluploadQueue=function(e){return e?(this.each(function(){var s,i,o,t,l,a;function p(l){l.status==plupload.DONE&&(a="plupload_done"),l.status==plupload.FAILED&&(a="plupload_failed"),l.status==plupload.QUEUED&&(a="plupload_delete"),l.status==plupload.UPLOADING&&(a="plupload_uploading");var a=n("#"+l.id).attr("class",a).find("a").css("display","block");l.hint&&a.attr("title",l.hint)}function u(){n("span.plupload_total_status",i).html(s.total.percent+"%"),n("div.plupload_progress_bar",i).css("width",s.total.percent+"%"),n("span.plupload_upload_status",i).html(plupload.sprintf(r("Uploaded %d/%d files"),s.total.uploaded,s.files.length))}function d(){var d,e=n("ul.plupload_filelist",i).html(""),t=0;n.each(s.files,function(l,a){d="",a.status==plupload.DONE&&(a.target_name&&(d+='<input type="hidden" name="'+o+"_"+t+'_tmpname" value="'+plupload.xmlEncode(a.target_name)+'" />'),d=(d+='<input type="hidden" name="'+o+"_"+t+'_name" value="'+plupload.xmlEncode(a.name)+'" />')+'<input type="hidden" name="'+o+"_"+t+'_status" value="'+(a.status==plupload.DONE?"done":"failed")+'" />',t++,n("#"+o+"_count").val(t)),e.append('<li id="'+a.id+'"><div class="plupload_file_name"><span>'+plupload.xmlEncode(a.name)+'</span></div><div class="plupload_file_action"><a href="#"></a></div><div class="plupload_file_status">'+a.percent+'%</div><div class="plupload_file_size">'+plupload.formatSize(a.size)+'</div><div class="plupload_clearer">&nbsp;</div>'+d+"</li>"),p(a),n("#"+a.id+".plupload_delete a").click(function(l){n("#"+a.id).remove(),s.removeFile(a),l.preventDefault()})}),n("span.plupload_total_file_size",i).html(plupload.formatSize(s.total.size)),0===s.total.queued?n("span.plupload_add_text",i).html(r("Add Files")):n("span.plupload_add_text",i).html(plupload.sprintf(r("%d files queued"),s.total.queued)),n("a.plupload_start",i).toggleClass("plupload_disabled",s.files.length==s.total.uploaded+s.total.failed),e[0].scrollTop=e[0].scrollHeight,u(),!s.files.length&&s.features.dragdrop&&s.settings.dragdrop&&n("#"+o+"_filelist").append('<li class="plupload_droptext">'+r("Drag files here.")+"</li>")}i=n(this),(o=i.attr("id"))||(o=plupload.guid(),i.attr("id",o)),t=i.html(),l=o,(a=i).contents().each(function(l,a){(a=n(a)).is(".plupload")||a.remove()}),a.prepend('<div class="plupload_wrapper plupload_scroll"><div id="'+l+'_container" class="plupload_container"><div class="plupload"><div class="plupload_header"><div class="plupload_header_content"><div class="plupload_header_title">'+r("Select files")+'</div><div class="plupload_header_text">'+r("Add files to the upload queue and click the start button.")+'</div></div></div><div class="plupload_content"><div class="plupload_filelist_header"><div class="plupload_file_name">'+r("Filename")+'</div><div class="plupload_file_action">&nbsp;</div><div class="plupload_file_status"><span>'+r("Status")+'</span></div><div class="plupload_file_size">'+r("Size")+'</div><div class="plupload_clearer">&nbsp;</div></div><ul id="'+l+'_filelist" class="plupload_filelist"></ul><div class="plupload_filelist_footer"><div class="plupload_file_name"><div class="plupload_buttons"><a href="#" class="plupload_button plupload_add" id="'+l+'_browse">'+r("Add Files")+'</a><a href="#" class="plupload_button plupload_start">'+r("Start Upload")+'</a></div><span class="plupload_upload_status"></span></div><div class="plupload_file_action"></div><div class="plupload_file_status"><span class="plupload_total_status">0%</span></div><div class="plupload_file_size"><span class="plupload_total_file_size">0 b</span></div><div class="plupload_progress"><div class="plupload_progress_container"><div class="plupload_progress_bar"></div></div></div><div class="plupload_clearer">&nbsp;</div></div></div></div></div><input type="hidden" id="'+l+'_count" name="'+l+'_count" value="0" /></div>'),(e=n.extend({dragdrop:!0,browse_button:o+"_browse",container:o},e)).dragdrop&&(e.drop_element=o+"_filelist"),s=new plupload.Uploader(e),(_[o]=s).bind("UploadFile",function(l,a){n("#"+a.id).addClass("plupload_current_file")}),s.bind("Init",function(p,l){!e.unique_names&&e.rename&&i.on("click","#"+o+"_filelist div.plupload_file_name span",function(l){var d=n(l.target),e="",t=p.getFile(d.parents("li")[0].id),l=t.name,a=/^(.+)(\.[^.]+)$/.exec(l);a&&(l=a[1],e=a[2]),d.hide().after('<input type="text" />'),d.next().val(l).focus().blur(function(){d.show().next().remove()}).keydown(function(l){var a=n(this);13==l.keyCode&&(l.preventDefault(),t.name=a.val()+e,d.text(t.name),a.blur())})}),n("#"+o+"_container").attr("title","Using runtime: "+l.runtime),n("a.plupload_start",i).click(function(l){n(this).hasClass("plupload_disabled")||s.start(),l.preventDefault()}),n("a.plupload_stop",i).click(function(l){l.preventDefault(),s.stop()}),n("a.plupload_start",i).addClass("plupload_disabled")}),s.bind("Error",function(l,a){var d,e=a.file;e&&(d=a.message,a.details&&(d+=" ("+a.details+")"),a.code==plupload.FILE_SIZE_ERROR&&alert(r("Error: File too large:")+" "+e.name),a.code==plupload.FILE_EXTENSION_ERROR&&alert(r("Error: Invalid file extension:")+" "+e.name),e.hint=d,n("#"+e.id).attr("class","plupload_failed").find("a").css("display","block").attr("title",d)),a.code===plupload.INIT_ERROR&&setTimeout(function(){delete _[o],s.destroy(),i.html(t),s=i=t=null},1)}),s.bind("PostInit",function(l){l.settings.dragdrop&&l.features.dragdrop&&n("#"+o+"_filelist").append('<li class="plupload_droptext">'+r("Drag files here.")+"</li>")}),s.init(),s.bind("StateChanged",function(){s.state===plupload.STARTED?(n("li.plupload_delete a,div.plupload_buttons",i).hide(),s.disableBrowse(!0),n("span.plupload_upload_status,div.plupload_progress,a.plupload_stop",i).css("display","block"),n("span.plupload_upload_status",i).html("Uploaded "+s.total.uploaded+"/"+s.files.length+" files"),e.multiple_queues&&n("span.plupload_total_status,span.plupload_total_file_size",i).show()):(d(),n("a.plupload_stop,div.plupload_progress",i).hide(),n("a.plupload_delete",i).css("display","block"),e.multiple_queues&&s.total.uploaded+s.total.failed==s.files.length&&(n(".plupload_buttons,.plupload_upload_status",i).css("display","inline"),s.disableBrowse(!1),n(".plupload_start",i).addClass("plupload_disabled"),n("span.plupload_total_status,span.plupload_total_file_size",i).hide()))}),s.bind("FilesAdded",d),s.bind("FilesRemoved",function(){var l=n("#"+o+"_filelist").scrollTop();d(),n("#"+o+"_filelist").scrollTop(l)}),s.bind("FileUploaded",function(l,a){p(a)}),s.bind("UploadProgress",function(l,a){n("#"+a.id+" div.plupload_file_status",i).html(a.percent+"%"),p(a),u()}),e.setup&&e.setup(s)}),this):_[n(this[0]).attr("id")]}}(jQuery);