let fullscreen=!1;function buildPhotoUrl(e,o){var t=e.collection_id,n=e.photo_key,e=e.photo_title,l=baseurl+"view_item.php?item="+n+"&collection="+t,t=baseurl+"item/photos/"+t+"/"+n+"/"+e,n=l;return"yes"==seoUrls&&"aho"==o?n=t:"aho"==o&&(n=l),n}function galleryDimension(){console.log("galleryDimension");var e=$("#gallery").height();$("#gallery .inner-holder").css("height",e+"px"),$("#gallery img").width()<$("#gallery img").height()?$("#gallery img").addClass("tall_img"):$("#gallery img").removeClass("tall_img")}function overlayDimension(){var e=$(window).height();$("#myNav .overlay-content").css("height",e+"px")}function refreshComments(e){0<$("#userCommentsList").length&&getAllComments("p",e.photo.photo_id,e.photo.photo_id.last_commented,1,e.photo.photo_id.total_comments,lang.photo)}function nextPrevPhoto(e,o,t){var n,e=$(e).data("check");"prev"==e&&(n="prev"),"next"==e&&(n="next"),data={photo_id:curr_photo.photo_id,collection_id:curr_photo.collection_id,direction:n,fullscreen:Number(fullscreen)},$.ajax({url:baseurl+"actions/photo_display.php",type:"post",data:data,dataType:"json",beforeSend:o,success:function(e){e.success?(curr_photo=e.photo,srcFirst=e.original_thumb,window.history.pushState("","",buildPhotoUrl(e.photo,"aho")),fullscreen?($("#main").replaceWith(e.html),refreshComments(e),t(e)):$("#main").fadeOut("0",function(){$("#main").replaceWith(e.html),$("#main").fadeIn("0").promise().done(function(){refreshComments(e),t(e)})})):""!=e.redirect&&(location.href=e.redirect)}})}function sample(){console.log("sample"),$("#gallery-exd").width()<$("#gallery-exd").height()?$("#gallery-exd").addClass("tallest"):$("#gallery-exd").removeClass("tallest")}function remove_enlarge(){$("body,#main").removeClass("image-zoom"),$("#myNav").attr("style","left:-100%;").removeClass("maximized")}function launchAfterLoad(e,o){$(e).each(function(){this.complete&&0!==this.naturalWidth?o():$(this).on("load",o)})}$(document).on("click","#mainNextBtn,#mainPrevBtn",function(){fullscreen=!1,nextPrevPhoto(this,function(){$(".photo-view").append(loader_black),$("#gallery").fadeTo("slow",.33),$(".view-photo").prop("disabled",!0)},function(){launchAfterLoad("#gallery img",galleryDimension)})}),$(document).on("click",".en-large",function(){fullscreen=!0,nextPrevPhoto(this,function(){$(".overlay-content").append(loader_white),$(".en-large").prop("disabled",!0)},function(){$(".en-large").prop("disabled",!1),$("#gallery").fadeTo("normal",.99),launchAfterLoad("#gallery-exd",sample),launchAfterLoad("#gallery img",galleryDimension)})}),$(document).on("keydown",function(e){$("#myNav").hasClass("maximized")?"ArrowLeft"==e.key?$(".en-large.view-photo-pre").trigger("click"):"ArrowRight"==e.key&&$(".en-large.view-photo-nxt").trigger("click"):"ArrowLeft"==e.key?$("#mainPrevBtn").trigger("click"):"ArrowRight"==e.key&&$("#mainNextBtn").trigger("click")}),$(document).ready(function(){galleryDimension()}),$(window).resize(function(){galleryDimension(),overlayDimension()}),$(document).on("click","#enlarge",function(){if($(this).attr("disabled"))return!1;$("body").addClass("image-zoom"),$("#myNav").attr("style","width:100%;left:0;"),$("#myNav").addClass("maximized"),$("#gallery-exd").attr("src",srcFirst),overlayDimension()}),$(document).on("click","#btn-close",remove_enlarge),$(document).on("keydown",function(e){27===e.keyCode&&remove_enlarge()}),$(".dropdown-menu li").on("click",function(){1<$("input#query").val().length&&$("#cbsearch").trigger("click")}),$(function(){_cb.listener_favorite("photo",curr_photo.photo_id),launchAfterLoad("#gallery-exd",sample)});